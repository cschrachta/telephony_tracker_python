<!DOCTYPE html>
{% load static %}
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" type="text/css" href="{% static 'styles/styles.css' %}">
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.3/css/jquery.dataTables.css">
  <!-- <link href="https://stackpath.bootstrapcdn.com/bootstrap/5.1.3/css/bootstrap.min.css" rel="stylesheet"> -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.1.3/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script type="text/javascript" charset="utf8" src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.11.3/js/jquery.dataTables.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
  {% block extra_css %}{% endblock %}
  {% load bootstrap5 %}
  {% bootstrap_css %}
  {% bootstrap_javascript %}
  <title>{% block title %}Telephony Tracker{% endblock %}</title>
</head>

<body>
  <header>
    <h1>Telephony Tracker</h1>
    {% include 'telephony/_navbar.html' %}
  </header>
  <main>
    <div class="container-fluid">
      <div class="d-flex">
        <div class="p-2 w-100">
          {% block content %}
          {% endblock %}
        </div>
      </div>
    </div>
  </main>
  <footer>
    <p>&copy; 2024 Telephony Tracker</p>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/5.1.3/js/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.11.6/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.1.3/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
  {% block extra_js %}
    <!-- <script async defer src="https://maps.googleapis.com/maps/api/js?key={{ GOOGLE_API_KEY }}&libraries=places"></script> 
    <script async src="https://maps.googleapis.com/maps/api/js?key={{ GOOGLE_API_KEY }}&loading=async&callback=initMap"></script> -->
    <script>
      function initAutocomplete() {
        var input = document.getElementById('id_address');
        var autocomplete = new google.maps.places.Autocomplete(input);
        autocomplete.addListener('place_changed', function () {
          var place = autocomplete.getPlace();
          if (!place.geometry) {
            return;
          }

          var addressComponents = place.address_components;
          var components = {
            street_number: 'short_name',
            route: 'long_name',
            locality: 'long_name',
            administrative_area_level_1: 'short_name',
            postal_code: 'short_name',
            country: 'short_name',
          };
          var address = {};
          for (var i = 0; i < addressComponents.length; i++) {
            var addressType = addressComponents[i].types[0];
            if (components[addressType]) {
              address[addressType] = addressComponents[i][components[addressType]];
            }
          }

          document.getElementById('id_house_number').value = address.street_number || '';
          document.getElementById('id_road').value = address.route || '';
          document.getElementById('id_city').value = address.locality || '';
          document.getElementById('id_state_abbreviation').value = address.administrative_area_level_1 || '';
          document.getElementById('id_postcode').value = address.postal_code || '';
          document.getElementById('id_country').value = address.country || '';
        });
      }
      document.addEventListener("DOMContentLoaded", function () {
        initAutocomplete();
      });
    </script>
  {% endblock %}
</body>
  
  </html>